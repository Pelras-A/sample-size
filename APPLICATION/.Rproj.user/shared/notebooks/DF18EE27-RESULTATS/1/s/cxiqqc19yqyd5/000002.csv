"0","model_final <- function(X){"
"0","  "
"0","  model <- X"
"0",""
"0","  for(cov in names(X)){"
"0","    "
"0","    model[,cov] <- X[,cov]*table_resultats[cov,""AVG""]"
"0",""
"0","  }"
"0","  "
"0","  sum.model <- rowSums(model, na.rm = TRUE)"
"0",""
"0","  pred.temp <- 0"
"0","  "
"0","  for(i in 1:(nb_ech_bootstrap*nb_BDD_completes)){"
"0","    "
"0","    tmp <- exp(matrix(exp(sum.model))%*%t(as.matrix(-1*RES$H0B[,i+1])))"
"0","    tmp[is.na(tmp)] <- 1"
"0","    pred.temp <- pred.temp + tmp"
"0","    "
"0","  }"
"0","  "
"0","  pred <- pred.temp/(nb_ech_bootstrap*nb_BDD_completes)"
"0","  "
"0","  "
"0","  table.temp <- data.frame(time = c(0,TIME$time), pred = c(1,pred[1,]))"
"0","  "
"0","  median <- table.temp[table.temp$pred==max(table.temp[table.temp$pred<=0.5,]$pred),]$time"
"0","  "
"0","  list(model = sum.model, table = table.temp, median = median)"
"0","  "
"0","}"
